<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trade | Trading Academy</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>

  <!-- Navigation -->
  <header>
    <nav>
      <ul>
        <li><a href="/home">Home</a></li>
        <li><a href="/trade">Trade</a></li>
        <li><a href="/portfolio">Portfolio</a></li>
        <li><a href="/glossary">Glossary</a></li>
        <li><a href="/articles">Articles</a></li>
        <li><a href="/progress">Progress</a></li>
      </ul>
    </nav>
  </header>

  <!-- Main Content -->
  <main>
    <h1>Trade Stocks</h1>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <!-- Trade Form -->
    <form action="/trade" method="POST">
      <label for="asset_name">Asset Name (Ticker):</label>
      <input type="text" id="asset_name" name="asset_name" placeholder="Enter stock symbol" required><br>

      <label for="quantity">Quantity (Optional):</label>
      <input type="number" id="quantity" name="quantity" placeholder="Enter quantity"><br>

      <button type="submit" name="action" value="buy" class="btn">Buy (Long)</button> 
      <button type="submit" name="action" value="short" class="btn">Short Sell</button> 
      <button type="submit" name="action" value="search" class="btn">Search Stock</button> 
    </form>

    <!-- Plotly Graph (Ensure this part renders the graph) -->
    <div id="stock-graph">
      {{ graph_html | safe }}  <!-- Adjusted to reflect how the graph is passed from backend -->
    </div>

    <!-- Company Information Section -->
    {% if company_info %}
    <h2>Company Overview for {{ asset_name }}</h2>
    <p><strong>Current Price:</strong> ${{ company_info.current_price }}</p>
    <p><strong>Market Cap:</strong> ${{ company_info.market_cap }}</p>
    <p><strong>P/E Ratio:</strong> {{ company_info.pe_ratio }}</p>
    <p><strong>52-Week High:</strong> ${{ company_info.high_52_week }}</p>
    <p><strong>52-Week Low:</strong> ${{ company_info.low_52_week }}</p>
    <p><strong>Description:</strong> {{ company_info.description }}</p>
    {% endif %}
  </main>

</body>
</html>
